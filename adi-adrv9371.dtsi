
#include <dt-bindings/iio/frequency/ad9528.h>

&spi0 {


	clk0_ad9528: ad9528-1@0 {
			#address-cells = <1>;
			#size-cells = <0>;
			#clock-cells = <1>;
			compatible = "ad9528";
	
			spi-max-frequency = <10000000>;
			//adi,spi-3wire-enable;
			reg = <0>;
	
			clock-output-names = "ad9528-1_out0", "ad9528-1_out1", "ad9528-1_out2", "ad9528-1_out3", "ad9528-1_out4", "ad9528-1_out5", 	"ad9528-1_out6", "ad9528-1_out7", "ad9528-1_out8", "ad9528-1_out9", "ad9528-1_out10", "ad9528-1_out11", "ad9528-1_out12", 	"ad9528-1_out13";
			adi,vcxo-freq = <30720000>;
	
			adi,refa-enable;
			adi,refa-diff-rcv-enable;
			adi,refa-r-div = <1>;
			//adi,osc-in-cmos-neg-inp-enable;
	
			/* PLL1 config */
			adi,pll1-feedback-div = <1>;
			adi,pll1-charge-pump-current-nA = <63500>;
	
	
			/* PLL2 config */
			adi,pll2-ndiv-a-cnt = <0>;
			adi,pll2-ndiv-b-cnt = <30>;
			adi,pll2-vco-diff-m1 = <3>; /* use 5 for 184320000 output device clock */
			adi,pll2-n2-div = <40>; /* N / M1 */
			adi,pll2-r1-div = <1>;
			adi,pll2-charge-pump-current-nA = <805000>;
	
			/* SYSREF config */
			adi,sysref-src = <SYSREF_SRC_INTERNAL>;
			adi,sysref-pattern-mode = <SYSREF_PATTERN_CONTINUOUS>;
			adi,sysref-k-div = <512>;
			adi,sysref-request-enable;
			adi,sysref-nshot-mode = <SYSREF_NSHOT_4_PULSES>;
			adi,sysref-request-trigger-mode = <SYSREF_LEVEL_HIGH>;
	
			adi,rpole2 = <RPOLE2_900_OHM>;
			adi,rzero = <RZERO_1850_OHM>;
			adi,cpole1 = <CPOLE1_16_PF>;
	
			adi,status-mon-pin0-function-select = <1>; /* PLL1 & PLL2 Locked */
			adi,status-mon-pin1-function-select = <7>; /* REFA Correct */

			ad9528_0_c0: channel@0 {
				reg = <0>;
				adi,extended-name = "C_AD9373_SYSREFCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_SYSREF_VCO>;
			};

			ad9528_0_c1: channel@1 {
				reg = <1>;
				adi,extended-name = "C_AD9373_DEVCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_VCO>;
			};

			ad9528_0_c2: channel@2 {
				reg = <2>;
				adi,extended-name = "D_AD9373_SYSREFCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_SYSREF_VCO>;
			};

			ad9528_0_c3: channel@3 {
				reg = <3>;
				adi,extended-name = "D_AD9373_DEVCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_VCO>;
			};
			ad9528_0_c4: channel@4 {
				reg = <4>;
				adi,extended-name = "A_AD9373_DEVCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_VCO>;
			};

			ad9528_0_c5: channel@5 {
				reg = <5>;
				adi,extended-name = "A_AD9373_SYSREFCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_SYSREF_VCO>;
			};

			ad9528_0_c6: channel@6 {
				reg = <6>;
				adi,extended-name = "B_AD9373_DEVCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_VCO>;
			};

			ad9528_0_c7: channel@7 {
				reg = <7>;
				adi,extended-name = "B_AD9373_SYSREFCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_SYSREF_VCO>;
			};
			ad9528_0_c8: channel@8 {
				reg = <8>;
				adi,extended-name = "S3_REFCLKP";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_VCO>;
			};
			
			ad9528_0_c9: channel@9 {
				reg = <9>;
				adi,extended-name = "S4_REFCLKP";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <8>;
				adi,signal-source = <SOURCE_VCO>;
			};

			ad9528_0_c10: channel@10 {
				reg = <10>;
				adi,extended-name = "S2_REFCLKP";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_VCO>;
			};

			ad9528_0_c11: channel@11 {
				reg = <11>;
				adi,extended-name = "FPGA_DEVCLK";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_VCO>;
			};

			ad9528_0_c12: channel@12 {
				reg = <12>;
				adi,extended-name = "FPGA_SYSREFCLK1";
				adi,driver-mode = <DRIVER_MODE_LVDS>;
				adi,divider-phase = <0>;
				adi,channel-divider = <10>;
				adi,signal-source = <SOURCE_SYSREF_VCO>;
			};

	};

	trx0_ad9371_a: ad9371-phy-a@1 {
		compatible = "adi,ad9371";
		reg = <1>;
		/* SPI Setup */
		spi-max-frequency = <25000000>;

		/* Clocks */
		clocks = <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 13>, <&clk0_ad9528 1>;
		clock-names = "jesd_rx_clk", "jesd_tx_clk",
			"jesd_rx_os_clk", "dev_clk", "fmc_clk",
			"sysref_dev_clk", "sysref_fmc_clk";

		clock-output-names = "rx_sampl_clk", "rx_os_sampl_clk", "tx_sampl_clk";
		#clock-cells = <1>;

		/include/ "ad9371_mux.dtsi"
	};

//	trx0_ad9371_b: ad9371-phy-b@2 {
//		compatible = "adi,ad9371";
//		reg = <2>;
//		/* SPI Setup */
//		spi-max-frequency = <25000000>;
//
//		/* Clocks */
//		clocks = <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 13>, <&clk0_ad9528 1>;
//		clock-names = "jesd_rx_clk", "jesd_tx_clk",
//			"jesd_rx_os_clk", "dev_clk", "fmc_clk",
//			"sysref_dev_clk", "sysref_fmc_clk";
//
//		clock-output-names = "rx_sampl_clk", "rx_os_sampl_clk", "tx_sampl_clk";
//		#clock-cells = <1>;
//
//		/include/ "ad9371_mux.dtsi"
//	};

};

&spi1 {

//	trx0_ad9371_c: ad9371-phy-a@1 {
//		compatible = "adi,ad9371";
//		reg = <1>;
//		/* SPI Setup */
//		spi-max-frequency = <25000000>;
//
//		/* Clocks */
//		clocks = <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 13>, <&clk0_ad9528 1>;
//		clock-names = "jesd_rx_clk", "jesd_tx_clk",
//			"jesd_rx_os_clk", "dev_clk", "fmc_clk",
//			"sysref_dev_clk", "sysref_fmc_clk";
//
//		clock-output-names = "rx_sampl_clk", "rx_os_sampl_clk", "tx_sampl_clk";
//		#clock-cells = <1>;
//
//		/include/ "ad9371_mux.dtsi"
//	};
//
//	trx0_ad9371_d: ad9371-phy-b@2 {
//		compatible = "adi,ad9371";
//		reg = <2>;
//		/* SPI Setup */
//		spi-max-frequency = <25000000>;
//
//		/* Clocks */
//		clocks = <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 1>, <&clk0_ad9528 13>, <&clk0_ad9528 1>;
//		clock-names = "jesd_rx_clk", "jesd_tx_clk",
//			"jesd_rx_os_clk", "dev_clk", "fmc_clk",
//			"sysref_dev_clk", "sysref_fmc_clk";
//
//		clock-output-names = "rx_sampl_clk", "rx_os_sampl_clk", "tx_sampl_clk";
//		#clock-cells = <1>;
//
//		/include/ "ad9371_mux.dtsi"
//	};

};